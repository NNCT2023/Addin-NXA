**ğŸ“š HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng HÃ m NXA_SewingExpert**

### ğŸŒŸ Chá»©c nÄƒng:

HÃ m `NXA_SewingExpert` ğŸ§µ biáº¿n Excel cá»§a báº¡n thÃ nh má»™t chuyÃªn gia vá» may ba lÃ´ vÃ  tÃºi xÃ¡ch! ğŸ’ğŸ‘œ HÃ m nÃ y sá»­ dá»¥ng mÃ´ hÃ¬nh ngÃ´n ngá»¯ Gemini cá»§a Google AI, Ä‘Æ°á»£c tÃ­ch há»£p sáºµn kiáº¿n thá»©c chuyÃªn sÃ¢u vá» ngÃ nh may máº·c. Báº¡n cÃ³ thá»ƒ cung cáº¥p dá»¯ liá»‡u vá» váº¥n Ä‘á» hoáº·c Ä‘áº·t cÃ¢u há»i, vÃ  AI sáº½ phÃ¢n tÃ­ch Ä‘á»ƒ Ä‘Æ°a ra cÃ¡c giáº£i phÃ¡p thá»±c táº¿, cháº©n Ä‘oÃ¡n váº¥n Ä‘á» vÃ  Ä‘á» xuáº¥t cáº£i tiáº¿n.

**HÃ m cÃ³ kháº£ nÄƒng:**

  - PhÃ¢n tÃ­ch dá»¯ liá»‡u Ä‘Æ°á»£c cung cáº¥p (tá»« má»™t `Range`).
  - Tráº£ lá»i cÃ¡c cÃ¢u há»i hoáº·c yÃªu cáº§u cá»¥ thá»ƒ cá»§a báº¡n.
  - LÆ°u trá»¯ lá»‹ch sá»­ tÆ°Æ¡ng tÃ¡c Ä‘á»ƒ theo dÃµi.
  - Cung cáº¥p pháº£n há»“i cÃ³ cáº¥u trÃºc theo yÃªu cáº§u.

---

### ğŸ“ CÃº phÃ¡p:

```=NXA_SewingExpert(rngData As Range, [prompt As String], [language As String], [structuredOutput As Boolean])```

### âš™ï¸ CÃ¡c Ä‘á»‘i sá»‘:
  - `rngData (Báº¯t buá»™c)`: ğŸ”‘ Kiá»ƒu dá»¯ liá»‡u Range. ÄÃ¢y lÃ  vÃ¹ng dá»¯ liá»‡u trong báº£ng tÃ­nh Excel mÃ  báº¡n muá»‘n chuyÃªn gia AI phÃ¢n tÃ­ch (vÃ­ dá»¥: dá»¯ liá»‡u vá» lá»—i sáº£n pháº©m, thÃ´ng sá»‘ váº­t liá»‡u, v.v.). Náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u, hÃ£y chá»n má»™t Ã´ trá»‘ng.

  - `prompt (TÃ¹y chá»n)`: âœï¸ Kiá»ƒu dá»¯ liá»‡u String. CÃ¢u há»i hoáº·c yÃªu cáº§u cá»¥ thá»ƒ báº¡n muá»‘n gá»­i Ä‘áº¿n chuyÃªn gia AI (vÃ­ dá»¥: "PhÃ¢n tÃ­ch nguyÃªn nhÃ¢n Ä‘Æ°á»ng may bá»‹ nhÄƒn vÃ  Ä‘Æ°a ra cÃ¡ch kháº¯c phá»¥c.").

  - `language (TÃ¹y chá»n)`: ğŸŒ Kiá»ƒu dá»¯ liá»‡u String. NgÃ´n ngá»¯ báº¡n muá»‘n AI tráº£ lá»i (máº·c Ä‘á»‹nh lÃ  "vi" cho tiáº¿ng Viá»‡t). Báº¡n cÃ³ thá»ƒ dÃ¹ng "en" cho tiáº¿ng Anh, v.v.

  - `structuredOutput (TÃ¹y chá»n)`: ğŸ“Š Kiá»ƒu dá»¯ liá»‡u Boolean. Náº¿u Ä‘áº·t lÃ  `TRUE`, AI sáº½ cung cáº¥p pháº£n há»“i cÃ³ cáº¥u trÃºc rÃµ rÃ ng vá»›i cÃ¡c má»¥c nhÆ° loáº¡i váº¥n Ä‘á», cÃ¡ch kháº¯c phá»¥c ngay láº­p tá»©c, cáº£i tiáº¿n dÃ i háº¡n vÃ  ghi chÃº. Máº·c Ä‘á»‹nh lÃ  `FALSE`.

---

### ğŸš€ CÃ¡ch sá»­ dá»¥ng:

  - **Äáº£m báº£o Cáº¥u hÃ¬nh API:** âš™ï¸ TrÆ°á»›c khi sá»­ dá»¥ng, hÃ£y cháº¯c cháº¯n ráº±ng báº¡n Ä‘Ã£ thiáº¿t láº­p Ä‘Ãºng API Key vÃ  Model trong file `config.txt` (xem chi tiáº¿t á»Ÿ pháº§n LÆ°u Ã½ Quan trá»ng).

  - **Nháº­p cÃ´ng thá»©c:** âŒ¨ï¸ Trong Ã´ báº¡n muá»‘n hiá»ƒn thá»‹ káº¿t quáº£ phÃ¢n tÃ­ch hoáº·c cÃ¢u tráº£ lá»i tá»« chuyÃªn gia, hÃ£y nháº­p cÃ´ng thá»©c `=NXA_SewingExpert(...)`.
Thay tháº¿ Ä‘á»‘i sá»‘:

    - `rngData:` ğŸ–±ï¸ Chá»n vÃ¹ng dá»¯ liá»‡u mÃ  báº¡n muá»‘n AI phÃ¢n tÃ­ch. Náº¿u báº¡n chá»‰ muá»‘n Ä‘áº·t cÃ¢u há»i mÃ  khÃ´ng cÃ³ dá»¯ liá»‡u cá»¥ thá»ƒ, hÃ£y chá»n má»™t Ã´ trá»‘ng.
    - `prompt (TÃ¹y chá»n)`: ğŸ’¡ Nháº­p cÃ¢u há»i hoáº·c yÃªu cáº§u cá»§a báº¡n (vÃ­ dá»¥: "LÃ m tháº¿ nÃ o Ä‘á»ƒ giáº£m thiá»ƒu Ä‘á»©t chá»‰ khi may nylon?").
    - `language (TÃ¹y chá»n)`: ğŸ—£ï¸ Nháº­p "`en`" náº¿u báº¡n muá»‘n cÃ¢u tráº£ lá»i báº±ng tiáº¿ng Anh.
    - `structuredOutput (TÃ¹y chá»n)`: ğŸ“ Nháº­p `TRUE` náº¿u báº¡n muá»‘n cÃ¢u tráº£ lá»i Ä‘Æ°á»£c trÃ¬nh bÃ y theo dáº¡ng gáº¡ch Ä‘áº§u dÃ²ng rÃµ rÃ ng.
  
**Nháº¥n Enter:** âœ… Sau khi nháº­p xong, nháº¥n Enter. Excel sáº½ gá»­i yÃªu cáº§u Ä‘áº¿n Gemini vÃ  hiá»ƒn thá»‹ phÃ¢n tÃ­ch hoáº·c giáº£i phÃ¡p trong Ã´.

---

### ğŸ’¡ VÃ­ dá»¥:

Giáº£ sá»­ báº¡n cÃ³ má»™t báº£ng dá»¯ liá»‡u vá» "`lá»—i Ä‘Æ°á»ng may`" á»Ÿ vÃ¹ng A1:C5 (vÃ­ dá»¥: Cá»™t A: Loáº¡i lá»—i, Cá»™t B: Váº­t liá»‡u, Cá»™t C: MÃ¡y sá»­ dá»¥ng) vÃ  báº¡n muá»‘n chuyÃªn gia AI phÃ¢n tÃ­ch:



+------------------------------------+-------------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------+
| ğŸ·ï¸ VÃ­ dá»¥                          | ğŸ“ MÃ´ táº£                                                     | ğŸ’¡ CÃº phÃ¡p hÃ m NXA_SewingExpert                                                      | ğŸ’¬ Káº¿t quáº£ dá»± kiáº¿n                                                                                |
+------------------------------------+-------------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------+
| 1ï¸âƒ£ PhÃ¢n tÃ­ch tá»•ng quÃ¡t cÃ³ dá»¯ liá»‡u | PhÃ¢n tÃ­ch cÃ¡c lá»—i Ä‘Æ°á»ng may phá»• biáº¿n trong dá»¯ liá»‡u tá»« vÃ¹ng | =NXA_SewingExpert(A1:C5, "PhÃ¢n tÃ­ch cÃ¡c lá»—i Ä‘Æ°á»ng may phá»• biáº¿n trong dá»¯ liá»‡u nÃ y vÃ  | AI sáº½ phÃ¢n tÃ­ch dá»¯ liá»‡u trong A1:C5 vÃ  Ä‘Æ°a ra cÃ¡c nháº­n Ä‘á»‹nh, giáº£i phÃ¡p tá»•ng quÃ¡t vá» lá»—i Ä‘Æ°á»ng may báº±ng |
|                                    | A1:C5 vÃ  Ä‘á» xuáº¥t giáº£i phÃ¡p báº±ng tiáº¿ng Viá»‡t, khÃ´ng cáº¥u trÃºc. | Ä‘á» xuáº¥t giáº£i phÃ¡p.", "vi", FALSE)                                                  | tiáº¿ng Viá»‡t.                                                                                        |
+------------------------------------+-------------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------+
| 2ï¸âƒ£ Äáº·t cÃ¢u há»i khÃ´ng cÃ³ dá»¯ liá»‡u  | Báº¡n khÃ´ng cÃ³ dá»¯ liá»‡u cá»¥ thá»ƒ nhÆ°ng muá»‘n há»i chuyÃªn gia vá»   | =NXA_SewingExpert("", "What are common causes of thread breakage and how to fix    | AI sáº½ tráº£ lá»i báº±ng tiáº¿ng Anh vá»›i cáº¥u trÃºc nhÆ°: 1. Type of issue, 2. Immediate fix, 3. Long-term    |
|                                    | váº¥n Ä‘á» Ä‘á»©t chá»‰ báº±ng tiáº¿ng Anh, cÃ³ cáº¥u trÃºc.                 | them?", "en", TRUE)                                                                 | improvement, 4. Notes, liÃªn quan Ä‘áº¿n váº¥n Ä‘á» Ä‘á»©t chá»‰.                                                |
+------------------------------------+-------------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------+
| 3ï¸âƒ£ Chá»‰ hiá»ƒn thá»‹ pháº£n há»“i gáº§n Ä‘Ã¢y  | KhÃ´ng cÃ³ dá»¯ liá»‡u hoáº·c prompt má»›i Ä‘Æ°á»£c cung cáº¥p. HÃ m sáº½ hiá»ƒn| =NXA_SewingExpert("", "", "vi", FALSE)                                             | Náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u hoáº·c prompt má»›i Ä‘Æ°á»£c cung cáº¥p, hÃ m sáº½ hiá»ƒn thá»‹ 3 pháº£n há»“i gáº§n Ä‘Ã¢y nháº¥t tá»« nháº­t |
|                                    | thá»‹ 3 pháº£n há»“i gáº§n Ä‘Ã¢y nháº¥t tá»« nháº­t kÃ½ tÆ°Æ¡ng tÃ¡c cá»§a báº¡n.   |                                                                                     | kÃ½ tÆ°Æ¡ng tÃ¡c cá»§a báº¡n.                                                                               |
+------------------------------------+-------------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------+



---

> [!IMPORTANT]
> ### ğŸ“Œ LÆ°u Ã½ quan trá»ng:

**Cáº¥u hÃ¬nh API: âš™ï¸**
  - HÃ m sá»­ dá»¥ng thÃ´ng tin cáº¥u hÃ¬nh tá»« file `config.txt` náº±m trong thÆ° má»¥c `C:\Users\{USERPROFILE}\Documents\ChatLogs\`.
  - File `config.txt` cáº§n chá»©a `API_KEY` vÃ  `MODEL` cá»§a Gemini.
  - Náº¿u file `config.txt` khÃ´ng tá»“n táº¡i, hÃ m sáº½ tá»± Ä‘á»™ng táº¡o má»™t file máº«u vá»›i hÆ°á»›ng dáº«n chi tiáº¿t. Báº¡n cáº§n thay tháº¿ `YOUR_API_KEY_HERE` báº±ng [API Key thá»±c táº¿ cá»§a báº¡n](https://aistudio.google.com/app/apikey).
  - Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i `Model` muá»‘n sá»­ dá»¥ng (vÃ­ dá»¥: gemini-1.5-pro cho phÃ¢n tÃ­ch nÃ¢ng cao, gemini-2.0-flash cho tá»‘c Ä‘á»™).

---

**Káº¿t ná»‘i internet:** ğŸŒ HÃ m cáº§n káº¿t ná»‘i internet á»•n Ä‘á»‹nh Ä‘á»ƒ gá»­i yÃªu cáº§u vÃ  nháº­n pháº£n há»“i tá»« API cá»§a Gemini.

**Äá»‹nh dáº¡ng dá»¯ liá»‡u:** ğŸ“Š Dá»¯ liá»‡u trong `rngData` sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh JSON Ä‘á»ƒ gá»­i Ä‘áº¿n API. HÃ£y Ä‘áº£m báº£o dá»¯ liá»‡u cá»§a báº¡n Ä‘Æ°á»£c sáº¯p xáº¿p theo dáº¡ng báº£ng vá»›i tiÃªu Ä‘á» rÃµ rÃ ng Ä‘á»ƒ Gemini hiá»ƒu tá»‘t nháº¥t.

**Äá»™ chÃ­nh xÃ¡c:** ğŸ¯ Cháº¥t lÆ°á»£ng káº¿t quáº£ phá»¥ thuá»™c vÃ o Ä‘á»™ rÃµ rÃ ng cá»§a cÃ¢u há»i/dá»¯ liá»‡u vÃ  kháº£ nÄƒng hiá»ƒu cá»§a Gemini.

**YÃªu cáº§u [`JsonConverter`](https://github.com/VBA-tools/VBA-JSON):** ğŸ§© HÃ m nÃ y cáº§n cÃ³ thÆ° viá»‡n [`JsonConverter`](https://github.com/VBA-tools/VBA-JSON) Ä‘á»ƒ xá»­ lÃ½ JSON. Äáº£m báº£o báº¡n Ä‘Ã£ cÃ i Ä‘áº·t vÃ  tham chiáº¿u thÆ° viá»‡n nÃ y trong VBA.

**Dá»‹ch vá»¥ cÃ³ phÃ­:** ğŸ’° Viá»‡c sá»­ dá»¥ng API cá»§a Gemini cÃ³ thá»ƒ phÃ¡t sinh chi phÃ­ theo sá»‘ lÆ°á»£ng yÃªu cáº§u vÃ  dá»¯ liá»‡u. HÃ£y tham kháº£o tÃ i liá»‡u cá»§a Google Cloud Platform.

**Lá»‹ch sá»­ tÆ°Æ¡ng tÃ¡c:** ğŸ’¾ Má»i tÆ°Æ¡ng tÃ¡c cÃ³ dá»¯ liá»‡u hoáº·c prompt má»›i sáº½ Ä‘Æ°á»£c ghi láº¡i trong file `Feedback_Log.txt` táº¡i `C:\Users\{USERPROFILE}\Documents\ChatLogs\`.

---

### ğŸ’¡ Máº¹o há»¯u Ã­ch:

- **Dá»¯ liá»‡u rÃµ rÃ ng:** ğŸ“ˆ LuÃ´n cung cáº¥p dá»¯ liá»‡u rÃµ rÃ ng, cÃ³ cáº¥u trÃºc vÃ  tiÃªu Ä‘á» cá»™t Ã½ nghÄ©a Ä‘á»ƒ AI cÃ³ thá»ƒ phÃ¢n tÃ­ch chÃ­nh xÃ¡c nháº¥t.

- **`Prompt cá»¥ thá»ƒ:`** ğŸ¯ Sá»­ dá»¥ng prompt Ä‘á»ƒ tÃ¹y chá»‰nh yÃªu cáº§u phÃ¢n tÃ­ch hoáº·c Ä‘áº·t cÃ¢u há»i chi tiáº¿t, giÃºp AI táº­p trung vÃ o váº¥n Ä‘á» báº¡n quan tÃ¢m.

- **Äáº§u ra cÃ³ cáº¥u trÃºc:** ğŸ“ Khi cáº§n thÃ´ng tin Ä‘á»ƒ bÃ¡o cÃ¡o hoáº·c theo dÃµi, hÃ£y sá»­ dá»¥ng `structuredOutput = TRUE` Ä‘á»ƒ nháº­n pháº£n há»“i dá»… Ä‘á»c vÃ  tá»•ng há»£p.

- **Kiá»ƒm tra nháº­t kÃ½:** ğŸ“š Náº¿u báº¡n khÃ´ng cung cáº¥p dá»¯ liá»‡u hoáº·c `prompt` má»›i, hÃ m sáº½ hiá»ƒn thá»‹ cÃ¡c pháº£n há»“i gáº§n Ä‘Ã¢y tá»« nháº­t kÃ½. ÄÃ¢y lÃ  cÃ¡ch hay Ä‘á»ƒ xem láº¡i cÃ¡c tÆ° váº¥n trÆ°á»›c Ä‘Ã³.

- **KhÃ¡m phÃ¡ Models:** ğŸ§  Thá»­ nghiá»‡m vá»›i cÃ¡c model Gemini khÃ¡c nhau (vÃ­ dá»¥: gemini-1.5-pro cho phÃ¢n tÃ­ch sÃ¢u hÆ¡n) trong file config.txt Ä‘á»ƒ xem model nÃ o phÃ¹ há»£p nháº¥t vá»›i nhu cáº§u cá»§a báº¡n.


> [!NOTE]
> Vá»›i hÃ m `NXA_SewingExpert`, báº¡n Ä‘Ã£ cÃ³ má»™t trá»£ lÃ½ chuyÃªn gia may máº·c máº¡nh máº½ ngay trong Excel, giÃºp báº¡n nhanh chÃ³ng giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» vÃ  Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh sáº£n xuáº¥t thÃ´ng minh hÆ¡n! ğŸš€
